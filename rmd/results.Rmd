---
title: "Results"
# author: Yanyu Liang
date: "`r format(Sys.time(), '%d %B, %Y')`"
---

```{r, echo=FALSE}
library(yaml)
reportThre <- function(meta) {
  threshold <- meta$`functional-subsetting`$`pval-theshold`
  cat('The threhold used for extracting functionally consistent variant is', threshold, '\n')
}
plotImage <- function(meta) {
  name <- paste0('https://rawgit.com/liangyy/phenotype-epistasis/master/code/step2/output-direction_XT_YI/', meta$`TRUE`, '__', meta$x1, '__', meta$x2, '/direction_yi.png')
  cat(paste0('![](', name, ')'), '\n')
  cat('\n')
}
listReports <- function(meta) {
  cat(paste0('1. Comparison of Beta [here](', 'https://rawgit.com/liangyy/phenotype-epistasis/master/code/step1/output-run_step1/', meta$`TRUE`, '__', meta$x1, '__', meta$x2, '/prs_report.html', ')'), '\n')
  cat(paste0('2. Marginal directions [here](https://rawgit.com/liangyy/phenotype-epistasis/master/code/step2/output-direction_XT_YI/', meta$`TRUE`, '__', meta$x1, '__', meta$x2, '/direction_report.html)'), '\n')
}
listSubset <- function(filename, subset) {
  meta <- yaml.load_file(filename)
  cat('###', subset, '\n', '\n')
  cat(paste0('Interaction test results are [here](https://rawgit.com/liangyy/phenotype-epistasis/master/code/step2/output-run_step2/', meta$`TRUE`, '__', meta$x1, '__', meta$x2, '/inter_report.', subset, '.html)'), '\n')
}
doAll <- function(filename) {
  meta <- yaml.load_file(filename)
  reportThre(meta)
  plotImage(meta)
  listReports(meta)
}
drawGraph <- function(gy, gi, yi, inter, filename='test'){
  tempfilepref <- 'temp-results-plot'
  sink(paste0(tempfilepref, '.tex'))
  t <- cat(paste0('\\', 'documentclass[preview]{standalone}
  \\', 'usepackage{tikz}
  \\', 'begin{document}
  \\', 'usetikzlibrary{fit,calc,positioning,decorations.pathreplacing,matrix}
  \\', 'usetikzlibrary{positioning}
  \\', 'usetikzlibrary{shapes, arrows, calc, positioning}
  \\', 'begin{tikzpicture}[auto]
  \\', 'tikzstyle{node}=[draw, rectangle, text centered, node distance=5em]
  \\', 'tikzstyle{inter}=[draw, circle,fill=black,inner sep=0pt,minimum size=3pt]
  \\', 'tikzstyle{arrow}=[draw, ->]
  \\', 'node [node] (y) {$Y$};
  \\', 'node [inter, below of=y] (inter) {};
  \\', 'node [node, below left of=inter] (g) {$G$};
  \\', 'node [node, below right of=inter] (i) {$I$};
  \\', 'path [arrow] (g) -- node [above,midway] {', gy, '} (y);
  \\', 'path [arrow] (g) -- node [above,midway] {', gi, '} (i);
  \\', 'path [arrow] (i) -- node [above,midway] {', yi, '} (y);
  \\', 'path [arrow] (g) -- (inter);
  \\', 'path [arrow] (i) -- (inter);
  \\', 'path [arrow] (inter) -- node [left,midway,xshift=1ex] {', inter, '} (y);
  \\', 'end{tikzpicture}
  \\', 'end{document} \n'))
  sink()
  cmd <- paste0('pdflatex ', tempfilepref, '.tex')
  system(cmd)
  cmd <- paste0('convert -density 300 ', tempfilepref, '.pdf -quality 90 ', 'intergraph.', filename, '.png')
  system(cmd)
  cat(paste0('![](', 'intergraph.', filename, '.png', ')'))
  cmd <- paste0('rm ../rmd/', tempfilepref, '.*')
  system(cmd)
  cat('\n')
}
```

# Summary

This page presents the results of analysis that have been done. Every section is one disease (phenotype of interest) and each subsection is the analysis for a particular intermediate trait.

Every subsection presents the following information.

* Comparison between raw $\beta$ and posterior mean of $\beta$ for computing PRS (This is not available now)
* Marginal association:
    - $Y \sim I$
    - $Y \sim G_i$
    - $Y \sim I + G_i$
* Interaction test results based on functional subsetting
* Follow up comment on the results (functional subsetting) if any
* Interaction test results based on significance subsetting (if run)
* Follow up comment on the results (significance subsetting) if any

# Coronary heart disease

## HDL

```{r, results='asis'}
config.hdl <- '../code/step2/config.wtccc-cad-hdl.yaml'
doAll(config.hdl)
listSubset(config.hdl, 'func_subset')
```

```{r, results='asis'}
listSubset(config.hdl, 'sig_subset')
```

## LDL

```{r, results='asis'}
config.ldl <- '../code/step2/config.wtccc-cad-ldl.yaml'
doAll(config.ldl)
listSubset(config.ldl, 'func_subset')
```

This [paper](http://circres.ahajournals.org/content/118/1/83) shows the strong genetic correlation between coronary heart disease and LDL and conditional FDR (on LDL; namely incorporating LDL p-value into FDR calculation) of CHD help to identify more signal out of GWAS follow-up study. Also, LDL has been shown to be causal factor of CHD, [paper](http://www.nejm.org.proxy.uchicago.edu/doi/full/10.1056/NEJMoa054013).

[*rs13465*](https://www.ncbi.nlm.nih.gov/projects/SNP/snp_ref.cgi?rs=13465) locates in the intronic region of ILF3. Its protective effect is masked by high LDL level.

```{r, results='asis'}
drawGraph('-', '-', '+', '+', 'cad-ldl') #
```

Interestingly, this [paper](https://www.spandidos-publications.com/mmr/4/3/511) reported that ILF3 (*rs2569512* was used to tag the gene) affects myocardial infarction risk only when LDL level is low (when LDL level is high, there is no association signal).

```{r, results='asis'}
listSubset(config.ldl, 'sig_subset')
```

Here, I list SNPs that have genome-wide significant p-value in GWAS and interaction p-value < 0.1

[*rs564398*](https://www.ncbi.nlm.nih.gov/projects/SNP/snp_ref.cgi?rs=564398) locates in the intronic region of CDKN2B-AS1 (CDKN2B antisense RNA 1). It is a known CHD locus [link](https://www.ncbi.nlm.nih.gov/gene/100048912). It protective effect goes away when LDL is high but there is no strong correlation between the locus and LDL level.

[*rs7865618*](https://www.ncbi.nlm.nih.gov/projects/SNP/snp_ref.cgi?rs=7865618) also locates in CDKN2B-AS1 (intronic region). It works in the same direction of *rs564398*.

[*rs7049105*](https://www.ncbi.nlm.nih.gov/projects/SNP/snp_ref.cgi?rs=7049105) also locates in CDKN2B-AS1 (intronic region). Its risk goes away when LDL level is high. This direction is also consistent with the previous two loci.

[*rs10965215*](https://www.ncbi.nlm.nih.gov/projects/SNP/snp_ref.cgi?rs=10965215) also locates in CDKN2B-AS1 (intronic region). The direction is the same as *rs7049105*.

[*rs10965219*](https://www.ncbi.nlm.nih.gov/projects/SNP/snp_ref.cgi?rs=7049105) also locates in CDKN2B-AS1 (intronic region). Same direction.

It seems that the effect of CDKN2B-AS1 on CHD is masked by high LDL in general. But no evidence support the interaction between CDKN2B-AS1 and LDL on CHD risk.


## Serum triglycerides concentration

```{r, results='asis'}
config.tg <- '../code/step2/config.wtccc-cad-tg.yaml'
doAll(config.tg)
listSubset(config.tg, 'func_subset')
```

This paper proposed that triglycerides level is also a causal factor of CHD, [paper](https://www-nature-com.proxy.uchicago.edu/articles/ng.2795).

[*rs4541125*](https://www.ncbi.nlm.nih.gov/projects/SNP/snp_ref.cgi?rs=4541125) shows most significant interaction (positive: i.e. as $I$ increases, the effect size of $G$ increases). In other word, the protective effect of $G$ goes away when $I$ is high. It locates in the intronic region of PITPNM3, which is reported to be under-presented in the proteomics of Acute Ischemic Strokes patients ([table 3 of the paper](https://pubs.acs.org/doi/full/10.1021/pr501324n?src=recsys)). Note that the triglycerides level is high in cases versus controls.

```{r, results='asis'}
drawGraph('-', '-', '+', '+', 'cad-tg')  # gy, gi, yi
```

```{r, results='asis'}
listSubset(config.tg, 'sig_subset')
```

## Leptin

```{r, results='asis'}
config.leptin <- '../code/step2/config.wtccc-cad-leptin.yaml'
doAll(config.leptin)
listSubset(config.leptin, 'func_subset')
```

# Crohn's disease

## C-reactive protein

It turns out that the GWAS signal goes away if limiting to loci which occur in WTCCC genotype data.

## Insulin-like growth factor

```{r, results='asis'}
config.igf1 <- '../code/step2/config.wtccc-crohn-igf1.yaml'
doAll(config.igf1)
listSubset(config.igf1, 'func_subset')
```

## White blood cell count

```{r, results='asis'}
config.wbc <- '../code/step2/config.wtccc-crohn-wbc.yaml'
doAll(config.wbc)
listSubset(config.wbc, 'func_subset')
```

[*rs7775228*](https://www.ncbi.nlm.nih.gov/projects/SNP/snp_ref.cgi?rs=7775228) is a tag SNP for HLA DQ2.2 haplotype [link](https://www.snpedia.com/index.php/Rs7775228).

Interestingly, when adding a sparse prior on the effect size, two SNPs ([*rs4379550*](https://www.ncbi.nlm.nih.gov/projects/SNP/snp_ref.cgi?rs=4379550) and [*rs11145756*](https://www.ncbi.nlm.nih.gov/projects/SNP/snp_ref.cgi?rs=rs11145756) are both located in the intronic region of SEC16A. And their interaction terms is negative, indicating that the SNP and intermediate trait act in redundant manner.

```{r, results='asis'}
drawGraph('+', '+', '+', '-', 'crohn-wbc')  # gy, gi, yi
```

```{r, results='asis'}
listSubset(config.wbc, 'sig_subset')
```

# Type II diabetes

## Fast glucose

```{r, results='asis'}
config.fastglu <- '../code/step2/config.wtccc-t2d-fastglu.yaml'
doAll(config.fastglu)
listSubset(config.fastglu, 'func_subset')
```

[*rs10509645*](https://www.ncbi.nlm.nih.gov/projects/SNP/snp_ref.cgi?rs=10509645) locates in the intronic region of [IDE](http://www.uniprot.org/uniprot/P14735).

[*rs5015480*](https://www.snpedia.com/index.php/Rs5015480) (gene: [HHEX](http://www.uniprot.org/uniprot/Q03014)).

For [*rs1243150*](https://www.ncbi.nlm.nih.gov/projects/SNP/snp_ref.cgi?rs=275775) and [*rs1243149*](https://www.ncbi.nlm.nih.gov/projects/SNP/snp_ref.cgi?rs=275774), the gene is unknown.

[*rs7923866*](https://www.ncbi.nlm.nih.gov/projects/SNP/snp_ref.cgi?rs=rs7923866) is also in the vicinity of the HHEX (homeobox, hematopoietically expressed) and IDE (insulin-degrading enzyme) [link](https://www.nature.com/articles/nature05911).

[*rs760233*](https://www.ncbi.nlm.nih.gov/projects/SNP/snp_ref.cgi?rs=760233) locates in the intronic region of [TTLL5](https://www.uniprot.org/uniprot/Q6EMB2), which is related to retinal development and has not been reported to be associated with T2D.

<!--

[*10811661*](https://www.ncbi.nlm.nih.gov/projects/SNP/snp_ref.cgi?rs=10811661) is strongly associated with T2D [link](https://www.snpedia.com/index.php/Rs10811661) which is located at upstream of CDKN2A/B. [This paper](http://diabetes.diabetesjournals.org/content/early/2018/02/05/db17-1055) proposed that *CDKN2A/B locus SNPs may impact T2D risk by modulating islet gene expression and beta
cell proliferation*.

[*rs2383208*](https://www.ncbi.nlm.nih.gov/projects/SNP/snp_ref.cgi?rs=2383208)  also locates near CDKN2A/2B [link](http://journals.plos.org/plosone/article?id=10.1371/journal.pone.0026953). -->

Overall, all the SNPs mentioned above have the same direction. Namely the protective effect is masked if the fast glucose background level is high.

```{r, results='asis'}
drawGraph('-', '-', '+', '+', 't2d-fastglu')  # gy, gi, yi
```

```{r, results='asis'}
listSubset(config.fastglu, 'sig_subset')
```

## Fast insulin

```{r, results='asis'}
config.fastinsulin <- '../code/step2/config.wtccc-t2d-fastinsulin.yaml'
doAll(config.fastinsulin)
listSubset(config.fastinsulin, 'func_subset')
```

[*rs2155105*](https://www.ncbi.nlm.nih.gov/projects/SNP/snp_ref.cgi?rs=2155105) locates in the intronic region of [RAB38](http://www.uniprot.org/uniprot/P57729). It is associated with albuminuria in T2D.

rs1996913, rs17606320, rs7544694, rs7543693, rs12173920, rs16895362,rs2049316, rs6864348 have almost no signal in $I \sim G$.

[*rs3734262*](https://www.ncbi.nlm.nih.gov/projects/SNP/snp_ref.cgi?rs=3734262) locates in the intronic region of [UHRF1](http://www.uniprot.org/uniprot/Q96T88) binding protein 1 ([UHRF1BP1](http://www.uniprot.org/uniprot/Q6BDS2))

[*rs9368834*](https://www.ncbi.nlm.nih.gov/projects/SNP/snp_ref.cgi?rs=9368834) locates in the intronic region of [ANKS1A](https://www.uniprot.org/uniprot/Q92625). It has been reported that this gene is associated with T2D in obese individuals.

[*rs2139980*](https://www.ncbi.nlm.nih.gov/projects/SNP/snp_ref.cgi?rs=2139980). It direction is not the same as others.

All SNPs but rs2139980 mentioned has protective effect on T2D and when background fast insulin is high, the protective effects become smaller. For rs2139980, its protective effect becomes even stronger.

```{r, results='asis'}
drawGraph('-', '-', '+', '+', 't2d-fastinsulin')  # gy, gi, yi
```

```{r, results='asis'}
listSubset(config.fastinsulin, 'sig_subset')
```
